"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.sort=sort;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_marked=_regenerator.default.mark(makeAscendingRun),_marked2=_regenerator.default.mark(reverseRun),_marked3=_regenerator.default.mark(gallopLeft),_marked4=_regenerator.default.mark(gallopRight),_marked5=_regenerator.default.mark(sort),DEFAULT_MIN_MERGE=32,YIELD_FREQ=63,DEFAULT_MIN_GALLOPING=7,DEFAULT_TMP_STORAGE_LENGTH=256,POWERS_OF_TEN=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function log10(a){return 1e5>a?100>a?10>a?0:1:1e4>a?1e3>a?2:3:4:1e7>a?1e6>a?5:6:1e9>a?1e8>a?7:8:9}function alphabeticalCompare(c,d){if(c===d)return 0;if(~~c===c&&~~d===d){if(0===c||0===d)return c<d?-1:1;if(0>c||0>d){if(0<=d)return-1;if(0<=c)return 1;c=-c,d=-d}var e=log10(c),f=log10(d),g=0;return e<f?(c*=POWERS_OF_TEN[f-e-1],d/=10,g=-1):e>f&&(d*=POWERS_OF_TEN[e-f-1],c/=10,g=1),c===d?g:c<d?-1:1}var h=c+"",i=d+"";return h===i?0:h<i?-1:1}function minRunLength(n){for(var r=0;n>=DEFAULT_MIN_MERGE;)r|=1&n,n>>=1;return n+r}function makeAscendingRun(a,b,c,d){var e;return _regenerator.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(e=b+1,e!==c){f.next=3;break}return f.abrupt("return",1);case 3:if(!(0>d(a[e++],a[b]))){f.next=14;break}case 4:if(!(e<c&&0>d(a[e],a[e-1]))){f.next=11;break}if(e++,0!=(e&YIELD_FREQ)){f.next=9;break}return void(f.next=9);case 9:f.next=4;break;case 11:return f.delegateYield(reverseRun(a,b,e),"t0",12);case 12:f.next=21;break;case 14:if(!(e<c&&0<=d(a[e],a[e-1]))){f.next=21;break}if(e++,0!=(e&YIELD_FREQ)){f.next=19;break}return void(f.next=19);case 19:f.next=14;break;case 21:return f.abrupt("return",e-b);case 22:case"end":return f.stop();}},_marked)}function reverseRun(a,b,c){var d;return _regenerator.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c--;case 1:if(!(b<c)){e.next=10;break}if(d=a[b],a[b++]=a[c],a[c--]=d,0!=(127&c)){e.next=8;break}return void(e.next=8);case 8:e.next=1;break;case 10:case"end":return e.stop();}},_marked2)}function binaryInsertionSort(a,b,c,d,e){for(d===b&&d++;d<c;d++){for(var f=a[d],g=b,h=d;g<h;){var i=g+h>>>1;0>e(f,a[i])?h=i:g=i+1}var n=d-g;switch(n){case 3:a[g+3]=a[g+2];case 2:a[g+2]=a[g+1];case 1:a[g+1]=a[g];break;default:for(;0<n;)a[g+n]=a[g+n-1],n--;}a[g]=f}}var yieldCounter=0;function checkYield(){return 0==(yieldCounter++&YIELD_FREQ)}function gallopLeft(a,b,c,d,e,f){var g,h,i,j,k;return _regenerator.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return void(l.next=2);case 2:if(g=0,h=0,i=1,!(0<f(a,b[c+e]))){l.next=21;break}h=d-e;case 7:if(!(i<h&&0<f(a,b[c+e+i]))){l.next=16;break}if(!checkYield()){l.next=11;break}return void(l.next=11);case 11:g=i,i=(i<<1)+1,0>=i&&(i=h),l.next=7;break;case 16:i>h&&(i=h),g+=e,i+=e,l.next=35;break;case 21:h=e+1;case 22:if(!(i<h&&0>=f(a,b[c+e-i]))){l.next=31;break}if(!checkYield()){l.next=26;break}return void(l.next=26);case 26:g=i,i=(i<<1)+1,0>=i&&(i=h),l.next=22;break;case 31:i>h&&(i=h),j=g,g=e-i,i=e-j;case 35:g++;case 36:if(!(g<i)){l.next=44;break}if(k=g+(i-g>>>1),!checkYield()){l.next=41;break}return void(l.next=41);case 41:0<f(a,b[c+k])?g=k+1:i=k,l.next=36;break;case 44:return l.abrupt("return",i);case 45:case"end":return l.stop();}},_marked3)}function gallopRight(a,b,c,d,e,f){var g,h,i,j,k;return _regenerator.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return void(l.next=2);case 2:if(g=0,h=0,i=1,!(0>f(a,b[c+e]))){l.next=22;break}h=e+1;case 7:if(!(i<h&&0>f(a,b[c+e-i]))){l.next=16;break}if(!checkYield()){l.next=11;break}return void(l.next=11);case 11:g=i,i=(i<<1)+1,0>=i&&(i=h),l.next=7;break;case 16:i>h&&(i=h),j=g,g=e-i,i=e-j,l.next=35;break;case 22:h=d-e;case 23:if(!(i<h&&0<=f(a,b[c+e+i]))){l.next=32;break}if(!checkYield()){l.next=27;break}return void(l.next=27);case 27:g=i,i=(i<<1)+1,0>=i&&(i=h),l.next=23;break;case 32:i>h&&(i=h),g+=e,i+=e;case 35:g++;case 36:if(!(g<i)){l.next=44;break}if(k=g+(i-g>>>1),!checkYield()){l.next=41;break}return void(l.next=41);case 41:0>f(a,b[c+k])?i=k:g=k+1,l.next=36;break;case 44:return l.abrupt("return",i);case 45:case"end":return l.stop();}},_marked4)}var TimSort=function(){function a(b,c){(0,_classCallCheck2.default)(this,a),(0,_defineProperty2.default)(this,"array",null),(0,_defineProperty2.default)(this,"compare",null),(0,_defineProperty2.default)(this,"minGallop",DEFAULT_MIN_GALLOPING),(0,_defineProperty2.default)(this,"length",0),(0,_defineProperty2.default)(this,"tmpStorageLength",DEFAULT_TMP_STORAGE_LENGTH),(0,_defineProperty2.default)(this,"stackLength",0),(0,_defineProperty2.default)(this,"runStart",null),(0,_defineProperty2.default)(this,"runLength",null),(0,_defineProperty2.default)(this,"stackSize",0),this.array=b,this.compare=c,this.length=b.length,this.length<2*DEFAULT_TMP_STORAGE_LENGTH&&(this.tmpStorageLength=this.length>>>1),this.tmp=Array(this.tmpStorageLength),this.stackLength=120>this.length?5:1542>this.length?10:119151>this.length?19:40,this.runStart=Array(this.stackLength),this.runLength=Array(this.stackLength)}return(0,_createClass2.default)(a,[{key:"pushRun",value:function pushRun(a,b){this.runStart[this.stackSize]=a,this.runLength[this.stackSize]=b,this.stackSize+=1}},{key:"mergeRuns",value:_regenerator.default.mark(function mergeRuns(){var n;return _regenerator.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(1<this.stackSize)){a.next=11;break}if(n=this.stackSize-2,!(1<=n&&this.runLength[n-1]<=this.runLength[n]+this.runLength[n+1]||2<=n&&this.runLength[n-2]<=this.runLength[n]+this.runLength[n-1])){a.next=6;break}this.runLength[n-1]<this.runLength[n+1]&&n--,a.next=8;break;case 6:if(!(this.runLength[n]>this.runLength[n+1])){a.next=8;break}return a.abrupt("break",11);case 8:return a.delegateYield(this.mergeAt(n),"t0",9);case 9:a.next=0;break;case 11:case"end":return a.stop();}},mergeRuns,this)})},{key:"forceMergeRuns",value:_regenerator.default.mark(function forceMergeRuns(){var n;return _regenerator.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(1<this.stackSize)){a.next=6;break}return n=this.stackSize-2,0<n&&this.runLength[n-1]<this.runLength[n+1]&&n--,a.delegateYield(this.mergeAt(n),"t0",4);case 4:a.next=0;break;case 6:case"end":return a.stop();}},forceMergeRuns,this)})},{key:"mergeAt",value:_regenerator.default.mark(function mergeAt(a){var b,c,d,e,f,g,h;return _regenerator.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return void(i.next=2);case 2:return b=this.compare,c=this.array,d=this.runStart[a],e=this.runLength[a],f=this.runStart[a+1],g=this.runLength[a+1],this.runLength[a]=e+g,a===this.stackSize-3&&(this.runStart[a+1]=this.runStart[a+2],this.runLength[a+1]=this.runLength[a+2]),this.stackSize--,i.delegateYield(gallopRight(c[f],c,d,e,0,b),"t0",12);case 12:if(h=i.t0,d+=h,e-=h,0!==e){i.next=17;break}return i.abrupt("return");case 17:return i.delegateYield(gallopLeft(c[d+e-1],c,f,g,g-1,b),"t1",18);case 18:if(g=i.t1,0!==g){i.next=21;break}return i.abrupt("return");case 21:if(!(e<=g)){i.next=25;break}return i.delegateYield(this.mergeLow(d,e,f,g),"t2",23);case 23:i.next=26;break;case 25:return i.delegateYield(this.mergeHigh(d,e,f,g),"t3",26);case 26:case"end":return i.stop();}},mergeAt,this)})},{key:"mergeLow",value:_regenerator.default.mark(function mergeLow(a,b,c,d){var e,f,g,h,j,k,l,m,n,o,p;return _regenerator.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:e=this.compare,f=this.array,g=this.tmp,h=0,h=0;case 5:if(!(h<b)){i.next=13;break}if(!checkYield()){i.next=9;break}return void(i.next=9);case 9:g[h]=f[a+h];case 10:h++,i.next=5;break;case 13:if(j=0,k=c,l=a,f[l++]=f[k++],0!=--d){i.next=28;break}h=0;case 19:if(!(h<b)){i.next=27;break}if(!checkYield()){i.next=23;break}return void(i.next=23);case 23:f[l+h]=g[j+h];case 24:h++,i.next=19;break;case 27:return i.abrupt("return");case 28:if(1!==b){i.next=40;break}h=0;case 30:if(!(h<d)){i.next=38;break}if(!checkYield()){i.next=34;break}return void(i.next=34);case 34:f[l+h]=f[k+h];case 35:h++,i.next=30;break;case 38:return f[l+d]=g[j],i.abrupt("return");case 40:m=this.minGallop;case 41:n=0,o=0,p=!1;case 45:if(!checkYield()){i.next=48;break}return void(i.next=48);case 48:if(!(0>e(f[k],g[j]))){i.next=57;break}if(f[l++]=f[k++],o++,n=0,0!=--d){i.next=55;break}return p=!0,i.abrupt("break",64);case 55:i.next=63;break;case 57:if(f[l++]=g[j++],n++,o=0,1!=--b){i.next=63;break}return p=!0,i.abrupt("break",64);case 63:if((n|o)<m){i.next=45;break}case 64:if(!p){i.next=66;break}return i.abrupt("break",121);case 66:if(!checkYield()){i.next=69;break}return void(i.next=69);case 69:return i.delegateYield(gallopRight(f[k],g,j,b,0,e),"t0",70);case 70:if(n=i.t0,0===n){i.next=87;break}h=0;case 73:if(!(h<n)){i.next=81;break}if(!checkYield()){i.next=77;break}return void(i.next=77);case 77:f[l+h]=g[j+h];case 78:h++,i.next=73;break;case 81:if(l+=n,j+=n,b-=n,!(1>=b)){i.next=87;break}return p=!0,i.abrupt("break",115);case 87:if(f[l++]=f[k++],0!=--d){i.next=91;break}return p=!0,i.abrupt("break",115);case 91:return i.delegateYield(gallopLeft(g[j],f,k,d,0,e),"t1",92);case 92:if(o=i.t1,0===o){i.next=109;break}h=0;case 95:if(!(h<o)){i.next=103;break}if(!checkYield()){i.next=99;break}return void(i.next=99);case 99:f[l+h]=f[k+h];case 100:h++,i.next=95;break;case 103:if(l+=o,k+=o,d-=o,0!==d){i.next=109;break}return p=!0,i.abrupt("break",115);case 109:if(f[l++]=g[j++],1!=--b){i.next=113;break}return p=!0,i.abrupt("break",115);case 113:m--;case 114:if(n>=DEFAULT_MIN_GALLOPING||o>=DEFAULT_MIN_GALLOPING){i.next=66;break}case 115:if(!p){i.next=117;break}return i.abrupt("break",121);case 117:0>m&&(m=0),m+=2,i.next=41;break;case 121:if(this.minGallop=m,1>m&&(this.minGallop=1),1!==b){i.next=136;break}h=0;case 125:if(!(h<d)){i.next=133;break}if(!checkYield()){i.next=129;break}return void(i.next=129);case 129:f[l+h]=f[k+h];case 130:h++,i.next=125;break;case 133:f[l+d]=g[j],i.next=149;break;case 136:if(0!==b){i.next=140;break}throw new Error("mergeLow preconditions were not respected");case 140:h=0;case 141:if(!(h<b)){i.next=149;break}if(!checkYield()){i.next=145;break}return void(i.next=145);case 145:f[l+h]=g[j+h];case 146:h++,i.next=141;break;case 149:case"end":return i.stop();}},mergeLow,this)})},{key:"mergeHigh",value:_regenerator.default.mark(function mergeHigh(a,b,c,d){var e,f,g,h,j,k,l,m,n,o,p,q,s;return _regenerator.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:e=this.compare,f=this.array,g=this.tmp,h=0,h=0;case 5:if(!(h<d)){i.next=13;break}if(!checkYield()){i.next=9;break}return void(i.next=9);case 9:g[h]=f[c+h];case 10:h++,i.next=5;break;case 13:if(j=a+b-1,k=d-1,l=c+d-1,m=0,n=0,f[l--]=f[j--],0!=--b){i.next=31;break}m=l-(d-1),h=0;case 22:if(!(h<d)){i.next=30;break}if(!checkYield()){i.next=26;break}return void(i.next=26);case 26:f[m+h]=g[h];case 27:h++,i.next=22;break;case 30:return i.abrupt("return");case 31:if(1!==d){i.next=47;break}l-=b,j-=b,n=l+1,m=j+1,h=b-1;case 37:if(!(0<=h)){i.next=45;break}if(!checkYield()){i.next=41;break}return void(i.next=41);case 41:f[n+h]=f[m+h];case 42:h--,i.next=37;break;case 45:return f[l]=g[k],i.abrupt("return");case 47:o=this.minGallop;case 48:p=0,q=0,s=!1;case 52:if(!checkYield()){i.next=55;break}return void(i.next=55);case 55:if(!(0>e(g[k],f[j]))){i.next=64;break}if(f[l--]=f[j--],p++,q=0,0!=--b){i.next=62;break}return s=!0,i.abrupt("break",71);case 62:i.next=70;break;case 64:if(f[l--]=g[k--],q++,p=0,1!=--d){i.next=70;break}return s=!0,i.abrupt("break",71);case 70:if((p|q)<o){i.next=52;break}case 71:if(!s){i.next=73;break}return i.abrupt("break",133);case 73:return i.t0=b,i.delegateYield(gallopRight(g[k],f,a,b,b-1,e),"t1",75);case 75:if(i.t2=i.t1,p=i.t0-i.t2,0===p){i.next=95;break}l-=p,j-=p,b-=p,n=l+1,m=j+1,h=p-1;case 84:if(!(0<=h)){i.next=92;break}if(!checkYield()){i.next=88;break}return void(i.next=88);case 88:f[n+h]=f[m+h];case 89:h--,i.next=84;break;case 92:if(0!==b){i.next=95;break}return s=!0,i.abrupt("break",127);case 95:if(f[l--]=g[k--],1!=--d){i.next=99;break}return s=!0,i.abrupt("break",127);case 99:return i.t3=d,i.delegateYield(gallopLeft(f[j],g,0,d,d-1,e),"t4",101);case 101:if(i.t5=i.t4,q=i.t3-i.t5,0===q){i.next=121;break}l-=q,k-=q,d-=q,n=l+1,m=k+1,h=0;case 110:if(!(h<q)){i.next=118;break}if(!checkYield()){i.next=114;break}return void(i.next=114);case 114:f[n+h]=g[m+h];case 115:h++,i.next=110;break;case 118:if(!(1>=d)){i.next=121;break}return s=!0,i.abrupt("break",127);case 121:if(f[l--]=f[j--],0!=--b){i.next=125;break}return s=!0,i.abrupt("break",127);case 125:o--;case 126:if(p>=DEFAULT_MIN_GALLOPING||q>=DEFAULT_MIN_GALLOPING){i.next=73;break}case 127:if(!s){i.next=129;break}return i.abrupt("break",133);case 129:0>o&&(o=0),o+=2,i.next=48;break;case 133:if(this.minGallop=o,1>o&&(this.minGallop=1),1!==d){i.next=152;break}l-=b,j-=b,n=l+1,m=j+1,h=b-1;case 141:if(!(0<=h)){i.next=149;break}if(!checkYield()){i.next=145;break}return void(i.next=145);case 145:f[n+h]=f[m+h];case 146:h--,i.next=141;break;case 149:f[l]=g[k],i.next=166;break;case 152:if(0!==d){i.next=156;break}throw new Error("mergeHigh preconditions were not respected");case 156:m=l-(d-1),h=0;case 158:if(!(h<d)){i.next=166;break}if(!checkYield()){i.next=162;break}return void(i.next=162);case 162:f[m+h]=g[h];case 163:h++,i.next=158;break;case 166:case"end":return i.stop();}},mergeHigh,this)})}]),a}();function sort(a,b,c,d){var e,f,g,h,i,j;return _regenerator.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(Array.isArray(a)){k.next=2;break}throw new TypeError("Can only sort arrays");case 2:if(b?"function"==typeof b?1===b.length&&(e=b,b=function(c,a){var b=e(c),d=e(a);return b===d?0:d>b?-1:1}):(d=c,c=b,b=alphabeticalCompare):b=alphabeticalCompare,c||(c=0),d||(d=a.length),f=d-c,!(2>f)){k.next=8;break}return k.abrupt("return",a);case 8:if(g=0,!(f<DEFAULT_MIN_MERGE)){k.next=16;break}return k.delegateYield(makeAscendingRun(a,c,d,b),"t0",11);case 11:return g=k.t0,binaryInsertionSort(a,c,d,c+g,b),void(k.next=15);case 15:return k.abrupt("return",a);case 16:h=new TimSort(a,b),i=minRunLength(f);case 18:return k.delegateYield(makeAscendingRun(a,c,d,b),"t1",19);case 19:if(g=k.t1,!(g<i)){k.next=27;break}return j=f,j>i&&(j=i),binaryInsertionSort(a,c,c+j,c+g,b),void(k.next=26);case 26:g=j;case 27:return h.pushRun(c,g),k.delegateYield(h.mergeRuns(),"t2",29);case 29:f-=g,c+=g;case 31:if(0!==f){k.next=18;break}case 32:return k.delegateYield(h.forceMergeRuns(),"t3",33);case 33:return k.abrupt("return",a);case 34:case"end":return k.stop();}},_marked5)}