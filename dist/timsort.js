"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports,"__esModule",{value:!0}),exports.sort=sort;var _classCallCheck2=_interopRequireDefault(require("@babel/runtime/helpers/classCallCheck")),_createClass2=_interopRequireDefault(require("@babel/runtime/helpers/createClass")),_defineProperty2=_interopRequireDefault(require("@babel/runtime/helpers/defineProperty")),_regenerator=_interopRequireDefault(require("@babel/runtime/regenerator")),_marked=_regenerator.default.mark(copy),_marked2=_regenerator.default.mark(makeAscendingRun),_marked3=_regenerator.default.mark(reverseRun),_marked4=_regenerator.default.mark(gallopLeft),_marked5=_regenerator.default.mark(gallopRight),_marked6=_regenerator.default.mark(sort),DEFAULT_MIN_MERGE=32,YIELD_FREQ=127,DEFAULT_MIN_GALLOPING=7,DEFAULT_TMP_STORAGE_LENGTH=256,POWERS_OF_TEN=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9];function log10(a){return 1e5>a?100>a?10>a?0:1:1e4>a?1e3>a?2:3:4:1e7>a?1e6>a?5:6:1e9>a?1e8>a?7:8:9}function copy(a,b,c){var d,e,f,g,h,k,l,m=arguments;return _regenerator.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:d=3<m.length&&void 0!==m[3]?m[3]:0,e=4<m.length&&void 0!==m[4]?m[4]:0,f=7&c,g=(-8&c)+d,h=d,k=e;case 6:if(!(h<g)){i.next=21;break}if(a[h]=b[k],a[h+1]=b[k+1],a[h+2]=b[k+2],a[h+3]=b[k+3],a[h+4]=b[k+4],a[h+5]=b[k+5],a[h+6]=b[k+6],a[h+7]=b[k+7],!checkYield()){i.next=18;break}return void(i.next=18);case 18:h+=8,k+=8,i.next=6;break;case 21:for(l=f+h;h<l;h++,k++)a[h]=b[k];case 23:case"end":return i.stop();}},_marked)}function alphabeticalCompare(c,d){if(c===d)return 0;if(~~c===c&&~~d===d){if(0===c||0===d)return c<d?-1:1;if(0>c||0>d){if(0<=d)return-1;if(0<=c)return 1;c=-c,d=-d}var e=log10(c),f=log10(d),g=0;return e<f?(c*=POWERS_OF_TEN[f-e-1],d/=10,g=-1):e>f&&(d*=POWERS_OF_TEN[e-f-1],c/=10,g=1),c===d?g:c<d?-1:1}var h=c+"",i=d+"";return h===i?0:h<i?-1:1}function minRunLength(n){for(var r=0;n>=DEFAULT_MIN_MERGE;)r|=1&n,n>>=1;return n+r}function makeAscendingRun(a,b,c,d){var e;return _regenerator.default.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(e=b+1,e!==c){f.next=3;break}return f.abrupt("return",1);case 3:if(!(0>d(a[e++],a[b]))){f.next=14;break}case 4:if(!(e<c&&0>d(a[e],a[e-1]))){f.next=11;break}if(e++,0!=(e&YIELD_FREQ)){f.next=9;break}return void(f.next=9);case 9:f.next=4;break;case 11:return f.delegateYield(reverseRun(a,b,e),"t0",12);case 12:f.next=21;break;case 14:if(!(e<c&&0<=d(a[e],a[e-1]))){f.next=21;break}if(e++,0!=(e&YIELD_FREQ)){f.next=19;break}return void(f.next=19);case 19:f.next=14;break;case 21:return f.abrupt("return",e-b);case 22:case"end":return f.stop();}},_marked2)}function reverseRun(a,b,c){var d;return _regenerator.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:c--;case 1:if(!(b<c)){e.next=10;break}if(d=a[b],a[b++]=a[c],a[c--]=d,0!=(127&c)){e.next=8;break}return void(e.next=8);case 8:e.next=1;break;case 10:case"end":return e.stop();}},_marked3)}function binaryInsertionSort(a,b,c,d,e){for(d===b&&d++;d<c;d++){for(var f=a[d],g=b,h=d;g<h;){var i=g+h>>>1;0>e(f,a[i])?h=i:g=i+1}var n=d-g;switch(n){case 3:a[g+3]=a[g+2];case 2:a[g+2]=a[g+1];case 1:a[g+1]=a[g];break;default:for(;0<n;)a[g+n]=a[g+n-1],n--;}a[g]=f}}var yieldCounter=0;function checkYield(){return 0==(yieldCounter++&YIELD_FREQ)}function gallopLeft(a,b,c,d,e,f){var g,h,i,j,k;return _regenerator.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return void(l.next=2);case 2:if(g=0,h=0,i=1,!(0<f(a,b[c+e]))){l.next=21;break}h=d-e;case 7:if(!(i<h&&0<f(a,b[c+e+i]))){l.next=16;break}if(!checkYield()){l.next=11;break}return void(l.next=11);case 11:g=i,i=(i<<1)+1,0>=i&&(i=h),l.next=7;break;case 16:i>h&&(i=h),g+=e,i+=e,l.next=35;break;case 21:h=e+1;case 22:if(!(i<h&&0>=f(a,b[c+e-i]))){l.next=31;break}if(!checkYield()){l.next=26;break}return void(l.next=26);case 26:g=i,i=(i<<1)+1,0>=i&&(i=h),l.next=22;break;case 31:i>h&&(i=h),j=g,g=e-i,i=e-j;case 35:g++;case 36:if(!(g<i)){l.next=44;break}if(k=g+(i-g>>>1),!checkYield()){l.next=41;break}return void(l.next=41);case 41:0<f(a,b[c+k])?g=k+1:i=k,l.next=36;break;case 44:return l.abrupt("return",i);case 45:case"end":return l.stop();}},_marked4)}function gallopRight(a,b,c,d,e,f){var g,h,i,j,k;return _regenerator.default.wrap(function(l){for(;;)switch(l.prev=l.next){case 0:return void(l.next=2);case 2:if(g=0,h=0,i=1,!(0>f(a,b[c+e]))){l.next=22;break}h=e+1;case 7:if(!(i<h&&0>f(a,b[c+e-i]))){l.next=16;break}if(!checkYield()){l.next=11;break}return void(l.next=11);case 11:g=i,i=(i<<1)+1,0>=i&&(i=h),l.next=7;break;case 16:i>h&&(i=h),j=g,g=e-i,i=e-j,l.next=35;break;case 22:h=d-e;case 23:if(!(i<h&&0<=f(a,b[c+e+i]))){l.next=32;break}if(!checkYield()){l.next=27;break}return void(l.next=27);case 27:g=i,i=(i<<1)+1,0>=i&&(i=h),l.next=23;break;case 32:i>h&&(i=h),g+=e,i+=e;case 35:g++;case 36:if(!(g<i)){l.next=44;break}if(k=g+(i-g>>>1),!checkYield()){l.next=41;break}return void(l.next=41);case 41:0>f(a,b[c+k])?i=k:g=k+1,l.next=36;break;case 44:return l.abrupt("return",i);case 45:case"end":return l.stop();}},_marked5)}var TimSort=function(){function a(b,c){(0,_classCallCheck2.default)(this,a),(0,_defineProperty2.default)(this,"array",null),(0,_defineProperty2.default)(this,"compare",null),(0,_defineProperty2.default)(this,"minGallop",DEFAULT_MIN_GALLOPING),(0,_defineProperty2.default)(this,"length",0),(0,_defineProperty2.default)(this,"tmpStorageLength",DEFAULT_TMP_STORAGE_LENGTH),(0,_defineProperty2.default)(this,"stackLength",0),(0,_defineProperty2.default)(this,"runStart",null),(0,_defineProperty2.default)(this,"runLength",null),(0,_defineProperty2.default)(this,"stackSize",0),this.array=b,this.compare=c,this.length=b.length,this.length<2*DEFAULT_TMP_STORAGE_LENGTH&&(this.tmpStorageLength=this.length>>>1),this.tmp=Array(this.tmpStorageLength),this.stackLength=120>this.length?5:1542>this.length?10:119151>this.length?19:40,this.runStart=Array(this.stackLength),this.runLength=Array(this.stackLength)}return(0,_createClass2.default)(a,[{key:"pushRun",value:function pushRun(a,b){this.runStart[this.stackSize]=a,this.runLength[this.stackSize]=b,this.stackSize+=1}},{key:"mergeRuns",value:_regenerator.default.mark(function mergeRuns(){var n;return _regenerator.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(1<this.stackSize)){a.next=11;break}if(n=this.stackSize-2,!(1<=n&&this.runLength[n-1]<=this.runLength[n]+this.runLength[n+1]||2<=n&&this.runLength[n-2]<=this.runLength[n]+this.runLength[n-1])){a.next=6;break}this.runLength[n-1]<this.runLength[n+1]&&n--,a.next=8;break;case 6:if(!(this.runLength[n]>this.runLength[n+1])){a.next=8;break}return a.abrupt("break",11);case 8:return a.delegateYield(this.mergeAt(n),"t0",9);case 9:a.next=0;break;case 11:case"end":return a.stop();}},mergeRuns,this)})},{key:"forceMergeRuns",value:_regenerator.default.mark(function forceMergeRuns(){var n;return _regenerator.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(1<this.stackSize)){a.next=6;break}return n=this.stackSize-2,0<n&&this.runLength[n-1]<this.runLength[n+1]&&n--,a.delegateYield(this.mergeAt(n),"t0",4);case 4:a.next=0;break;case 6:case"end":return a.stop();}},forceMergeRuns,this)})},{key:"mergeAt",value:_regenerator.default.mark(function mergeAt(a){var b,c,d,e,f,g,h;return _regenerator.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return void(i.next=2);case 2:return b=this.compare,c=this.array,d=this.runStart[a],e=this.runLength[a],f=this.runStart[a+1],g=this.runLength[a+1],this.runLength[a]=e+g,a===this.stackSize-3&&(this.runStart[a+1]=this.runStart[a+2],this.runLength[a+1]=this.runLength[a+2]),this.stackSize--,i.delegateYield(gallopRight(c[f],c,d,e,0,b),"t0",12);case 12:if(h=i.t0,d+=h,e-=h,0!==e){i.next=17;break}return i.abrupt("return");case 17:return i.delegateYield(gallopLeft(c[d+e-1],c,f,g,g-1,b),"t1",18);case 18:if(g=i.t1,0!==g){i.next=21;break}return i.abrupt("return");case 21:if(!(e<=g)){i.next=25;break}return i.delegateYield(this.mergeLow(d,e,f,g),"t2",23);case 23:i.next=26;break;case 25:return i.delegateYield(this.mergeHigh(d,e,f,g),"t3",26);case 26:case"end":return i.stop();}},mergeAt,this)})},{key:"mergeLow",value:_regenerator.default.mark(function mergeLow(a,b,c,d){var e,f,g,h,j,k,l,m,n,o,p;return _regenerator.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return e=this.compare,f=this.array,g=this.tmp,h=0,i.delegateYield(copy(g,f,b,0,a),"t0",5);case 5:if(j=0,k=c,l=a,f[l++]=f[k++],0!=--d){i.next=12;break}return i.delegateYield(copy(f,g,b,l,j),"t1",11);case 11:return i.abrupt("return");case 12:if(1!==b){i.next=16;break}return i.delegateYield(copy(f,f,d,l,k),"t2",14);case 14:return f[l+d]=g[j],i.abrupt("return");case 16:m=this.minGallop;case 17:n=0,o=0,p=!1;case 21:if(!checkYield()){i.next=24;break}return void(i.next=24);case 24:if(!(0>e(f[k],g[j]))){i.next=33;break}if(f[l++]=f[k++],o++,n=0,0!=--d){i.next=31;break}return p=!0,i.abrupt("break",40);case 31:i.next=39;break;case 33:if(f[l++]=g[j++],n++,o=0,1!=--b){i.next=39;break}return p=!0,i.abrupt("break",40);case 39:if((n|o)<m){i.next=21;break}case 40:if(!p){i.next=42;break}return i.abrupt("break",81);case 42:if(!checkYield()){i.next=45;break}return void(i.next=45);case 45:return i.delegateYield(gallopRight(f[k],g,j,b,0,e),"t3",46);case 46:if(n=i.t3,0===n){i.next=55;break}return i.delegateYield(copy(f,g,n,l,j),"t4",49);case 49:if(l+=n,j+=n,b-=n,!(1>=b)){i.next=55;break}return p=!0,i.abrupt("break",75);case 55:if(f[l++]=f[k++],0!=--d){i.next=59;break}return p=!0,i.abrupt("break",75);case 59:return i.delegateYield(gallopLeft(g[j],f,k,d,0,e),"t5",60);case 60:if(o=i.t5,0===o){i.next=69;break}return i.delegateYield(copy(f,f,o,l,k),"t6",63);case 63:if(l+=o,k+=o,d-=o,0!==d){i.next=69;break}return p=!0,i.abrupt("break",75);case 69:if(f[l++]=g[j++],1!=--b){i.next=73;break}return p=!0,i.abrupt("break",75);case 73:m--;case 74:if(n>=DEFAULT_MIN_GALLOPING||o>=DEFAULT_MIN_GALLOPING){i.next=42;break}case 75:if(!p){i.next=77;break}return i.abrupt("break",81);case 77:0>m&&(m=0),m+=2,i.next=17;break;case 81:if(this.minGallop=m,1>m&&(this.minGallop=1),1!==b){i.next=88;break}return i.delegateYield(copy(f,f,d,l,k),"t7",85);case 85:f[l+d]=g[j],i.next=93;break;case 88:if(0!==b){i.next=92;break}throw new Error("mergeLow preconditions were not respected");case 92:return i.delegateYield(copy(f,g,b,l,j),"t8",93);case 93:case"end":return i.stop();}},mergeLow,this)})},{key:"mergeHigh",value:_regenerator.default.mark(function mergeHigh(a,b,c,d){var e,f,g,h,j,k,l,m,n,o,p,q,s;return _regenerator.default.wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return e=this.compare,f=this.array,g=this.tmp,h=0,i.delegateYield(copy(g,f,d,0,c),"t0",5);case 5:if(j=a+b-1,k=d-1,l=c+d-1,m=0,n=0,f[l--]=f[j--],0!=--b){i.next=15;break}return m=l-(d-1),i.delegateYield(copy(f,g,d,m,0),"t1",14);case 14:return i.abrupt("return");case 15:if(1!==d){i.next=31;break}l-=b,j-=b,n=l+1,m=j+1,h=b-1;case 21:if(!(0<=h)){i.next=29;break}if(!checkYield()){i.next=25;break}return void(i.next=25);case 25:f[n+h]=f[m+h];case 26:h--,i.next=21;break;case 29:return f[l]=g[k],i.abrupt("return");case 31:o=this.minGallop;case 32:p=0,q=0,s=!1;case 36:if(!checkYield()){i.next=39;break}return void(i.next=39);case 39:if(!(0>e(g[k],f[j]))){i.next=48;break}if(f[l--]=f[j--],p++,q=0,0!=--b){i.next=46;break}return s=!0,i.abrupt("break",55);case 46:i.next=54;break;case 48:if(f[l--]=g[k--],q++,p=0,1!=--d){i.next=54;break}return s=!0,i.abrupt("break",55);case 54:if((p|q)<o){i.next=36;break}case 55:if(!s){i.next=57;break}return i.abrupt("break",109);case 57:return i.t2=b,i.delegateYield(gallopRight(g[k],f,a,b,b-1,e),"t3",59);case 59:if(i.t4=i.t3,p=i.t2-i.t4,0===p){i.next=79;break}l-=p,j-=p,b-=p,n=l+1,m=j+1,h=p-1;case 68:if(!(0<=h)){i.next=76;break}if(!checkYield()){i.next=72;break}return void(i.next=72);case 72:f[n+h]=f[m+h];case 73:h--,i.next=68;break;case 76:if(0!==b){i.next=79;break}return s=!0,i.abrupt("break",103);case 79:if(f[l--]=g[k--],1!=--d){i.next=83;break}return s=!0,i.abrupt("break",103);case 83:return i.t5=d,i.delegateYield(gallopLeft(f[j],g,0,d,d-1,e),"t6",85);case 85:if(i.t7=i.t6,q=i.t5-i.t7,0===q){i.next=97;break}return l-=q,k-=q,d-=q,n=l+1,m=k+1,i.delegateYield(copy(f,g,q,n,m),"t8",94);case 94:if(!(1>=d)){i.next=97;break}return s=!0,i.abrupt("break",103);case 97:if(f[l--]=f[j--],0!=--b){i.next=101;break}return s=!0,i.abrupt("break",103);case 101:o--;case 102:if(p>=DEFAULT_MIN_GALLOPING||q>=DEFAULT_MIN_GALLOPING){i.next=57;break}case 103:if(!s){i.next=105;break}return i.abrupt("break",109);case 105:0>o&&(o=0),o+=2,i.next=32;break;case 109:if(this.minGallop=o,1>o&&(this.minGallop=1),1!==d){i.next=128;break}l-=b,j-=b,n=l+1,m=j+1,h=b-1;case 117:if(!(0<=h)){i.next=125;break}if(!checkYield()){i.next=121;break}return void(i.next=121);case 121:f[n+h]=f[m+h];case 122:h--,i.next=117;break;case 125:f[l]=g[k],i.next=134;break;case 128:if(0!==d){i.next=132;break}throw new Error("mergeHigh preconditions were not respected");case 132:return m=l-(d-1),i.delegateYield(copy(f,g,d,m,0),"t9",134);case 134:case"end":return i.stop();}},mergeHigh,this)})}]),a}();function simpleCompare(c,a){return c===a?0:c>a?1:-1}function sort(a,b,c,d){var e,f,g,h,i,j;return _regenerator.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:if(Array.isArray(a)){k.next=2;break}throw new TypeError("Can only sort arrays");case 2:if(b?"function"==typeof b?1===b.length&&(e=b,b=function(c,a){var b=e(c),d=e(a);return b===d?0:d>b?-1:1}):(d=c,c=b,b=simpleCompare):b=simpleCompare,c||(c=0),d||(d=a.length),f=d-c,!(2>f)){k.next=8;break}return k.abrupt("return",a);case 8:if(g=0,!(f<DEFAULT_MIN_MERGE)){k.next=16;break}return k.delegateYield(makeAscendingRun(a,c,d,b),"t0",11);case 11:return g=k.t0,binaryInsertionSort(a,c,d,c+g,b),void(k.next=15);case 15:return k.abrupt("return",a);case 16:h=new TimSort(a,b),i=minRunLength(f);case 18:return k.delegateYield(makeAscendingRun(a,c,d,b),"t1",19);case 19:if(g=k.t1,!(g<i)){k.next=27;break}return j=f,j>i&&(j=i),binaryInsertionSort(a,c,c+j,c+g,b),void(k.next=26);case 26:g=j;case 27:return h.pushRun(c,g),k.delegateYield(h.mergeRuns(),"t2",29);case 29:f-=g,c+=g;case 31:if(0!==f){k.next=18;break}case 32:return k.delegateYield(h.forceMergeRuns(),"t3",33);case 33:return k.abrupt("return",a);case 34:case"end":return k.stop();}},_marked6)}